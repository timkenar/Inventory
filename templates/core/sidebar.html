<aside 
  id="sidebar" 
  class="bg-gray-800 text-white p-4 shadow-lg transition-all duration-300 {% if is_collapsed %}sidebar-collapsed{% else %}sidebar-expanded{% endif %}"
  hx-target="this"
  hx-swap="outerHTML"
>
  <div class="flex items-center justify-between mb-6">
    <h2 style="font-family:serif" class="text-xl font-bold {% if is_collapsed %}hidden{% else %}sidebar-text{% endif %}">Inventory App</h2>
    <button 
      hx-get="{% url 'core:toggle_sidebar' %}" 
      class="text-white hover:text-gray-300 focus:outline-none"
    >
      <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
    </button>
  </div>

  <nav class="space-y-2 flex-1">
    <a href="{% url 'core:dashboard' %}" class="flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium group">
      <svg class="h-5 w-5 mr-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"/></svg>
      <span class="{% if is_collapsed %}hidden{% else %}sidebar-text{% endif %}">Dashboard</span>
    </a>
    <a href="{% url 'core:inventory' %}" class="flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium group">
      <svg class="h-5 w-5 mr-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 6h16v2H4V6zM4 11h16v2H4v-2zM4 16h16v2H4v-2z"/></svg>
      <span class="{% if is_collapsed %}hidden{% else %}sidebar-text{% endif %}">Inventory</span>
    </a>
    <a href="{% url 'core:sales' %}" class="flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium group">
      <svg class="h-5 w-5 mr-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M13 7h5v2h-5V7zM3 7h5v2H3V7zm0 6h5v2H3v-2zm10 0h5v2h-5v-2z"/></svg>
      <span class="{% if is_collapsed %}hidden{% else %}sidebar-text{% endif %}">Sales</span>
    </a>
    <a href="{% url 'core:purchases' %}" class="flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium group">
      <svg class="h-5 w-5 mr-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 4h12v2H4V4zm0 5h12v2H4V9zm0 5h12v2H4v-2z"/></svg>
      <span class="{% if is_collapsed %}hidden{% else %}sidebar-text{% endif %}">Purchases</span>
    </a>
    <a href="{% url 'core:reports' %}" class="flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium group">
      <svg class="h-5 w-5 mr-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9 8.5h2v2H9V8.5zM9 12h2v2H9v-2zm4-3.5h2v2h-2V8.5zm0 3.5h2v2h-2v-2zM5 8.5h2v2H5V8.5zM5 12h2v2H5v-2z"/></svg>
      <span class="{% if is_collapsed %}hidden{% else %}sidebar-text{% endif %}">Reports</span>
    </a>
  </nav>

  {% if user.is_authenticated %}
  <div class="mt-auto relative group">
    <button class="flex items-center w-full p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200">
      <svg class="h-5 w-5 mr-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
      </svg>
      <span class="{% if is_collapsed %}hidden{% else %}sidebar-text truncate{% endif %}">{{ user.username }}</span>
    </button>
    <div class="absolute left-0 bottom-full mb-2 w-64 bg-white rounded-lg shadow-lg hidden group-hover:block">
      <div class="py-2">
        <span class="block px-4 py-2 text-sm text-gray-700">Email: {{ user.email }}</span>
        <span class="block px-4 py-2 text-sm text-gray-700">Name: {{ user.first_name }} {{ user.last_name }}</span>
        <button 
          hx-get="{% url 'core:profile_edit' %}" 
          hx-target="#profile-popup" 
          hx-swap="innerHTML"
          class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
          onclick="document.getElementById('profile-popup-overlay').style.display='block'"
        >
          Edit Profile
        </button>
        <a href="{% url 'core:logout' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Logout</a>
      </div>
    </div>
  </div>
  {% endif %}
</aside>